{
  "permissions": {
    "allow": [
      "Bash(bash:*)",
      "Bash(/tmp/test_reprocess.sh:*)",
      "Bash(chmod:*)",
      "Bash(/tmp/enum_analysis.md << 'EOF'\n# ptt-enum.sh Language Analysis\n\n## Current Implementation Stats\n- **Total Lines**: 910\n- **Functions**: 11\n- **External Tool Calls**: ~233 \\(nmap, nikto, feroxbuster, grep, sed, sort, cat, etc.\\)\n- **Shell Constructs**: ~266 \\(echo, read, if/while/for loops\\)\n\n## Code Breakdown by Category\n\n### 1. External Tool Orchestration \\(~60%\\)\n- Running nmap, nikto, whatweb, cewl, feroxbuster\n- Piping between tools \\(grep, sed, sort, cat\\)\n- File operations \\(combining wordlists, processing outputs\\)\n\n### 2. Interactive User Prompts \\(~15%\\)\n- Port management UI\n- Extension management UI\n- Scan type selection\n- Manual input validation\n\n### 3. Text Processing \\(~15%\\)\n- Parsing nmap output\n- Extracting directories from scan results\n- Removing ANSI codes\n- Formatting reports\n\n### 4. Control Flow \\(~10%\\)\n- Argument parsing\n- Mode handling \\(preview, reprocess, transcript\\)\n- Error handling with safe_run\\(\\)\nEOF)",
      "Bash(/tmp/test_html_report.sh:*)",
      "Bash(/tmp/sample_report.html << 'HTML'\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Sample Enumeration Report</title>\n    <style>\n        * { margin: 0; padding: 0; box-sizing: border-box; }\n        body {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n            background: linear-gradient\\(135deg, #667eea 0%, #764ba2 100%\\);\n            padding: 20px;\n            min-height: 100vh;\n        }\n        .container {\n            max-width: 1400px;\n            margin: 0 auto;\n            background: white;\n            border-radius: 10px;\n            box-shadow: 0 20px 60px rgba\\(0,0,0,0.3\\);\n            overflow: hidden;\n        }\n        header {\n            background: linear-gradient\\(135deg, #2d3748 0%, #1a202c 100%\\);\n            color: white;\n            padding: 30px 40px;\n            border-bottom: 4px solid #667eea;\n        }\n        header h1 {\n            font-size: 2.5em;\n            margin-bottom: 10px;\n            text-shadow: 2px 2px 4px rgba\\(0,0,0,0.3\\);\n        }\n        header .meta {\n            color: #cbd5e0;\n            font-size: 0.95em;\n        }\n        .toc {\n            background: #f7fafc;\n            padding: 30px 40px;\n            border-bottom: 1px solid #e2e8f0;\n        }\n        .toc h2 {\n            color: #2d3748;\n            margin-bottom: 20px;\n            font-size: 1.5em;\n        }\n        .toc ul {\n            list-style: none;\n            display: grid;\n            grid-template-columns: repeat\\(auto-fit, minmax\\(250px, 1fr\\)\\);\n            gap: 10px;\n        }\n        .toc li a {\n            display: block;\n            padding: 12px 20px;\n            background: white;\n            border-left: 4px solid #667eea;\n            border-radius: 5px;\n            color: #2d3748;\n            text-decoration: none;\n            transition: all 0.3s ease;\n            box-shadow: 0 2px 4px rgba\\(0,0,0,0.1\\);\n        }\n        .toc li a:hover {\n            background: #667eea;\n            color: white;\n            transform: translateX\\(5px\\);\n            box-shadow: 0 4px 8px rgba\\(0,0,0,0.2\\);\n        }\n        .content { padding: 40px; }\n        .section {\n            margin-bottom: 40px;\n            background: #f7fafc;\n            border-radius: 8px;\n            overflow: hidden;\n            box-shadow: 0 4px 6px rgba\\(0,0,0,0.1\\);\n        }\n        .section-header {\n            background: linear-gradient\\(135deg, #667eea 0%, #764ba2 100%\\);\n            color: white;\n            padding: 20px 30px;\n            font-size: 1.3em;\n            font-weight: 600;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n        }\n        .section-header .badge {\n            background: rgba\\(255,255,255,0.2\\);\n            padding: 5px 15px;\n            border-radius: 20px;\n            font-size: 0.8em;\n            font-weight: normal;\n        }\n        .section-content {\n            background: #1e1e1e;\n            color: #d4d4d4;\n            padding: 20px;\n            max-height: 600px;\n            overflow-y: auto;\n            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;\n            font-size: 13px;\n            line-height: 1.5;\n            white-space: pre-wrap;\n            word-wrap: break-word;\n        }\n        .section-content::-webkit-scrollbar { width: 12px; }\n        .section-content::-webkit-scrollbar-track { background: #2d2d2d; }\n        .section-content::-webkit-scrollbar-thumb {\n            background: #667eea;\n            border-radius: 6px;\n        }\n        .section-content::-webkit-scrollbar-thumb:hover { background: #764ba2; }\n        footer {\n            background: #2d3748;\n            color: #cbd5e0;\n            padding: 20px 40px;\n            text-align: center;\n            font-size: 0.9em;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <header>\n            <h1>üîç Enumeration Report: example.com</h1>\n            <div class=\"meta\">\n                Generated: 2024-02-05 15:30:00 | Output Directory: report_example.com | Tool: ptt-enum.sh\n            </div>\n        </header>\n        <div class=\"toc\">\n            <h2>üìã Table of Contents</h2>\n            <ul>\n                <li><a href=\"#nmap\">Nmap Port Scan</a></li>\n                <li><a href=\"#feroxbuster\">Feroxbuster Results</a></li>\n                <li><a href=\"#nikto\">Nikto Scan</a></li>\n            </ul>\n        </div>\n        <div class=\"content\">\n            <div class=\"section\" id=\"nmap\">\n                <div class=\"section-header\">\n                    <span>üåê Nmap Port Scan</span>\n                    <span class=\"badge\">25 lines</span>\n                </div>\n                <div class=\"section-content\">PORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu\n80/tcp   open  http    Apache httpd 2.4.41\n443/tcp  open  ssl/http Apache httpd 2.4.41\n8080/tcp open  http-proxy Squid 4.10</div>\n            </div>\n            <div class=\"section\" id=\"feroxbuster\">\n                <div class=\"section-header\">\n                    <span>üìÅ Feroxbuster Directory Enumeration</span>\n                    <span class=\"badge\">12 lines</span>\n                </div>\n                <div class=\"section-content\">200 GET  15l  30w  345c http://example.com/index.html\n200 GET  20l  45w  567c http://example.com/login.php\n301 GET   9l  28w  312c http://example.com/admin/</div>\n            </div>\n        </div>\n        <footer>\n            Generated by ptt-enum.sh | Penetration Testing Tools | Use for authorized testing only\n        </footer>\n    </div>\n</body>\n</html>\nHTML)",
      "Bash(/tmp/sample_sidebar_report.html << 'HTML'\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Sample Report - Fixed Sidebar</title>\n    <style>\n        * { margin: 0; padding: 0; box-sizing: border-box; }\n        body {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n            background: linear-gradient\\(135deg, #667eea 0%, #764ba2 100%\\);\n            min-height: 100vh;\n        }\n        .container { display: flex; min-height: 100vh; }\n        \n        /* Fixed Sidebar */\n        .sidebar {\n            position: fixed;\n            left: 0;\n            top: 0;\n            width: 280px;\n            height: 100vh;\n            background: linear-gradient\\(180deg, #2d3748 0%, #1a202c 100%\\);\n            color: white;\n            overflow-y: auto;\n            box-shadow: 4px 0 15px rgba\\(0,0,0,0.3\\);\n            z-index: 1000;\n        }\n        .sidebar::-webkit-scrollbar { width: 8px; }\n        .sidebar::-webkit-scrollbar-track { background: #1a202c; }\n        .sidebar::-webkit-scrollbar-thumb { background: #667eea; border-radius: 4px; }\n        \n        .sidebar-header {\n            padding: 30px 20px;\n            border-bottom: 2px solid #667eea;\n            background: rgba\\(102, 126, 234, 0.1\\);\n        }\n        .sidebar-header h2 {\n            font-size: 1.3em;\n            margin-bottom: 5px;\n            color: #667eea;\n        }\n        .sidebar-header .subtitle {\n            font-size: 0.85em;\n            color: #cbd5e0;\n            font-weight: normal;\n        }\n        \n        .toc { padding: 20px 0; }\n        .toc ul { list-style: none; }\n        .toc li { margin-bottom: 5px; }\n        .toc li a {\n            display: block;\n            padding: 12px 20px;\n            color: #e2e8f0;\n            text-decoration: none;\n            transition: all 0.3s ease;\n            border-left: 4px solid transparent;\n            font-size: 0.95em;\n        }\n        .toc li a:hover {\n            background: rgba\\(102, 126, 234, 0.2\\);\n            border-left-color: #667eea;\n            color: white;\n            padding-left: 25px;\n        }\n        \n        /* Main Content */\n        .main-content {\n            margin-left: 280px;\n            flex: 1;\n            background: white;\n        }\n        header {\n            background: linear-gradient\\(135deg, #2d3748 0%, #1a202c 100%\\);\n            color: white;\n            padding: 40px 50px;\n            border-bottom: 4px solid #667eea;\n        }\n        header h1 { font-size: 2.5em; margin-bottom: 10px; }\n        header .meta { color: #cbd5e0; font-size: 0.95em; }\n        \n        .content { padding: 40px 50px; background: #f7fafc; min-height: 100vh; }\n        \n        .section {\n            margin-bottom: 40px;\n            background: white;\n            border-radius: 8px;\n            overflow: hidden;\n            box-shadow: 0 4px 6px rgba\\(0,0,0,0.1\\);\n        }\n        .section-header {\n            background: linear-gradient\\(135deg, #667eea 0%, #764ba2 100%\\);\n            color: white;\n            padding: 20px 30px;\n            font-size: 1.3em;\n            font-weight: 600;\n        }\n        .section-content {\n            background: #1e1e1e;\n            color: #d4d4d4;\n            padding: 20px;\n            max-height: 600px;\n            overflow-y: auto;\n            font-family: 'Consolas', 'Monaco', monospace;\n            font-size: 13px;\n            line-height: 1.5;\n        }\n        .section-content::-webkit-scrollbar { width: 12px; }\n        .section-content::-webkit-scrollbar-track { background: #2d2d2d; }\n        .section-content::-webkit-scrollbar-thumb { background: #667eea; border-radius: 6px; }\n        \n        footer {\n            background: #2d3748;\n            color: #cbd5e0;\n            padding: 20px 40px;\n            text-align: center;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <!-- Fixed Sidebar -->\n        <div class=\"sidebar\">\n            <div class=\"sidebar-header\">\n                <h2>üìã Navigation</h2>\n                <div class=\"subtitle\">Jump to section</div>\n            </div>\n            <nav class=\"toc\">\n                <ul>\n                    <li><a href=\"#nmap\">üåê Nmap Port Scan</a></li>\n                    <li><a href=\"#whatweb\">üîé WhatWeb Analysis</a></li>\n                    <li><a href=\"#nikto\">üõ°Ô∏è Nikto Scan</a></li>\n                    <li><a href=\"#feroxbuster\">üìÅ Feroxbuster</a></li>\n                    <li><a href=\"#cewl\">üìù CeWL Wordlist</a></li>\n                </ul>\n            </nav>\n        </div>\n\n        <!-- Main Content -->\n        <div class=\"main-content\">\n            <header>\n                <h1>üîç Enumeration Report: example.com</h1>\n                <div class=\"meta\">\n                    Generated: 2024-02-05 15:30:00 | Output: report_example.com | Tool: ptt-enum.sh\n                </div>\n            </header>\n            <div class=\"content\">\n                <div class=\"section\" id=\"nmap\">\n                    <div class=\"section-header\">üåê Nmap Port Scan</div>\n                    <div class=\"section-content\">PORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu\n80/tcp   open  http    Apache httpd 2.4.41\n443/tcp  open  ssl/http Apache httpd 2.4.41\n8080/tcp open  http-proxy Squid 4.10\n\n... \\(scroll down to see more content\\) ...</div>\n                </div>\n                \n                <div class=\"section\" id=\"whatweb\">\n                    <div class=\"section-header\">üîé WhatWeb Analysis</div>\n                    <div class=\"section-content\">=== Port 80 ===\nhttp://example.com:80 [200 OK] Apache[2.4.41], HTML5...</div>\n                </div>\n                \n                <div class=\"section\" id=\"nikto\">\n                    <div class=\"section-header\">üõ°Ô∏è Nikto Vulnerability Scan</div>\n                    <div class=\"section-content\">=== Port 80 ===\n- Nikto v2.1.6\n+ Target IP: 192.168.1.100...</div>\n                </div>\n                \n                <div class=\"section\" id=\"feroxbuster\">\n                    <div class=\"section-header\">üìÅ Feroxbuster Directory Enumeration</div>\n                    <div class=\"section-content\">=== QUICK Scan - Port 80 ===\n200 GET  15l  30w  345c http://example.com/index.html\n200 GET  20l  45w  567c http://example.com/login.php...</div>\n                </div>\n                \n                <div class=\"section\" id=\"cewl\">\n                    <div class=\"section-header\">üìù Custom Wordlist \\(CeWL\\)</div>\n                    <div class=\"section-content\">COMMAND USED:\ncewl \"http://example.com:80\" -d 5 -m 4\n--------------------------------------------\nadmin\nlogin\npassword\ndashboard...</div>\n                </div>\n            </div>\n            <footer>\n                Generated by ptt-enum.sh | Penetration Testing Tools | Use for authorized testing only\n            </footer>\n        </div>\n    </div>\n</body>\n</html>\nHTML)",
      "Bash(if [[ \"$OSTYPE\" == \"msys\")",
      "Bash(\"$OSTYPE\" == \"win32\" ]])",
      "Bash(then)",
      "Bash(else)",
      "Bash(fi)",
      "Bash(/tmp/test_target_inference.sh:*)"
    ]
  }
}
